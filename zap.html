<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>RibbsZn - Card√°pio Digital</title>
    <link rel="stylesheet" href="zap.css" />
  </head>
  <body>
    <div
      id="backdrop"
      class="backdrop"
      onclick="closeModal('popupCustom'); closeCaldaPopup(); closeModal('modalModoEntrega'); closeModal('modalDados'); closeImagePopup();"
    ></div>

    <header>
      <div class="header-content">
        <div class="logo-area">
          <span class="logo-text">RibbsZn</span>
        </div>
      </div>
    </header>

    <div class="sessao-topo" id="sessao-topo">
      <button class="active" onclick="showCategory('Promo√ß√µes',this)">
        Promo√ß√µes
      </button>
      <button onclick="showCategory('Artesanais',this)">Artesanais</button>
      <button onclick="showCategory('Costela Bovina',this)">Combos</button>
      <button onclick="showCategory('Batata Frita',this)">Batatas</button>
      <button onclick="showCategory('Bebidas',this)">Bebidas</button>
      <button onclick="showCategory('Milk Shakes',this)">Milk Shakes</button>
    </div>

    <div class="cardapio" id="cardapio"></div>

    <div id="footerCart">
      <div class="cart-header" onclick="toggleCart()">
        <span id="cartIcon">üõí</span>
        <span id="cartCount">0</span>
      </div>

      <div id="cartItemsContainer">
        <div id="cartItems"></div>

        <div id="upsellContainer" style="display: none">
          <div class="upsell-header">Aproveite tamb√©m:</div>
          <div class="upsell-scroll" id="upsellList"></div>
        </div>

        <div class="cart-actions">
          <div
            style="
              display: flex;
              justify-content: space-between;
              color: #fff;
              margin-bottom: 10px;
              font-weight: bold;
            "
          >
            <span>Total:</span>
            <span id="cartTotalDisplay">R$ 0,00</span>
          </div>
          <button id="btnFinalizar" onclick="iniciarCheckout()">
            Finalizar Pedido ‚ûî
          </button>
          <button id="btnLimpar" onclick="clearCart()">Limpar Tudo</button>
        </div>
      </div>
    </div>

    <div id="popupCustom" class="popup">
      <h3 id="popupCustomTitle" style="color: var(--amarelo); margin-top: 0">
        Personalizar
      </h3>
      <div id="popupQuestion"></div>
      <button class="btn-primary" onclick="confirmSimpleCustom()">
        Confirmar e Adicionar
      </button>
      <button
        onclick="closeModal('popupCustom')"
        style="
          width: 100%;
          background: none;
          border: none;
          color: #bbb;
          margin-top: 10px;
          cursor: pointer;
        "
      >
        Cancelar
      </button>
    </div>

    <div id="popupCalda" class="popup">
      <h3 style="color: var(--amarelo)">Escolha a Calda:</h3>
      <button class="btn-primary" onclick="selectCalda('Morango')">
        Morango
      </button>
      <button
        class="btn-primary"
        onclick="selectCalda('Chocolate')"
        style="margin-top: 10px"
      >
        Chocolate
      </button>
      <button
        class="btn-primary"
        onclick="selectCalda('Caramelo')"
        style="margin-top: 10px"
      >
        Caramelo
      </button>
      <button
        onclick="closeCaldaPopup()"
        style="
          width: 100%;
          background: none;
          border: none;
          color: #bbb;
          margin-top: 15px;
        "
      >
        Voltar
      </button>
    </div>

    <div id="modalModoEntrega" class="popup">
      <h3>Como deseja receber?</h3>
      <button class="btn-primary" onclick="selecionarModo('retirada')">
        Retirada (Balc√£o)
      </button>
      <button
        class="btn-primary"
        onclick="selecionarModo('entrega')"
        style="margin-top: 10px"
      >
        Delivery (Entrega)
      </button>
    </div>

    <div id="modalDados" class="popup">
      <button class="btn-close-modal" onclick="closeModal('modalDados')">
        &times;
      </button>
      <h3>Finalizar Pedido</h3>
      <form onsubmit="enviarZap(event)">
        <input type="text" id="inputNome" placeholder="Seu Nome" required />

        <div id="areaEntrega" style="display: none">
          <input
            type="text"
            id="inputEndereco"
            placeholder="Endere√ßo completo (Rua, n¬∫, Bairro)"
            required
          />

          <select id="selectBairro" onchange="atualizarTaxaEntrega()">
            <option value="" disabled selected>Confirme o Bairro</option>
            <option value="Campo Grande" data-taxa="0">
              Campo Grande (C√°lculo por dist√¢ncia)
            </option>
            <option value="Aflitos" data-taxa="6">Aflitos (R$ 6,00)</option>
            <option value="Arruda" data-taxa="5">Arruda (R$ 5,00)</option>
            <option value="√Ågua Fria" data-taxa="7">√Ågua Fria (R$ 7,00)</option>
            <option value="Encruzilhada" data-taxa="5">
              Encruzilhada (R$ 5,00)
            </option>
            <option value="Jardim Brasil" data-taxa="6">
              Jardim Brasil (R$ 6,00)
            </option>
            <option value="Peixinhos" data-taxa="5">Peixinhos (R$ 5,00)</option>
            <option value="Salgadinho" data-taxa="5">
              Salgadinho (R$ 5,00)
            </option>
            <option value="S√≠tio Novo" data-taxa="3">
              S√≠tio Novo (R$ 3,00)
            </option>
          </select>
        </div>

        <select id="selectPagamento" onchange="verificarTroco()" required>
          <option value="" disabled selected>Forma de Pagamento</option>
          <option value="PIX">PIX</option>
          <option value="Cart√£o">Cart√£o</option>
          <option value="Dinheiro">Dinheiro</option>
        </select>

        <div id="areaTroco" style="display: none">
          <input
            type="number"
            id="inputTroco"
            placeholder="Quanto voc√™ pagar√° ao todo?"
          />
        </div>

        <div class="resumo-final">
          <p>Subtotal: <span id="resumoSubtotal">R$ 0,00</span></p>
          <p id="linhaTaxa">Taxa: <span id="resumoTaxa">R$ 0,00</span></p>
          <p class="total-big">Total: <span id="resumoTotal">R$ 0,00</span></p>
        </div>

        <button type="submit" class="btn-whatsapp">
          Enviar para o WhatsApp üì≤
        </button>
      </form>
    </div>

    <div id="popupImage" class="popup" style="padding: 0; background: none">
      <img
        id="enlargedImage"
        src=""
        style="width: 100%; border-radius: 10px"
        onclick="closeImagePopup()"
      />
    </div>

    <audio id="soundClick" src="beep.mp3"></audio>
    <audio id="soundAdd" src="beep.mp3"></audio>

    <script>
      ((g) => {
        var h,
          a,
          k,
          p = "The Google Maps JavaScript API",
          c = "google",
          l = "importLibrary",
          q = "__ib__",
          m = document,
          b = window;
        b = b[c] || (b[c] = {});
        var d = b.maps || (b.maps = {}),
          r = new Set(),
          e = new URLSearchParams(),
          u = () =>
            h ||
            (h = new Promise(async (f, n) => {
              await (a = m.createElement("script"));
              e.set("libraries", [...r] + "");
              for (k in g)
                e.set(
                  k.replace(/[A-Z]/g, (t) => "_" + t[0].toLowerCase()),
                  g[k]
                );
              e.set("callback", c + ".maps." + q);
              a.src = `https://maps.${c}apis.com/maps/api/js?` + e;
              d[q] = f;
              a.onerror = () => (h = n(Error(p + " could not load.")));
              a.nonce = m.querySelector("script[nonce]")?.nonce || "";
              m.head.append(a);
            }));
        d[l]
          ? console.warn(p + " only loads once. Re-using existing library.")
          : (d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)));
      })({
        key: "AIzaSyD2QL7hEmor0FQxBWS9p5wAk3XnczkIzXo",
        v: "weekly",
      });
    </script>

    <script type="module">
      import { initAutocomplete } from "./zap.js";
      // Chama a inicializa√ß√£o assim que as bibliotecas estiverem prontas
      google.maps.importLibrary("places").then(() => {
        initAutocomplete();
      });
    </script>
    <script type="module" src="zap.js"></script>
  </body>
</html>
